{"version":3,"sources":["../bower_components/selection-sharer/dist/selection-sharer.js"],"names":["a","b","c","this","elements","sel","textSelection","htmlSelection","getSelectionText","d","window","getSelection","rangeCount","e","document","createElement","f","g","appendChild","getRangeAt","cloneContents","textContent","innerHTML","selectionDirection","createRange","anchorNode","setStart","anchorOffset","setEnd","focusNode","focusOffset","collapsed","detach","showPopunder","popunder","getElementById","isCollapsed","length","match","hidePopunder","classList","contains","style","bottom","endContainer","parentNode","Math","ceil","getBoundingClientRect","top","nextElementSibling","pushSiblings","placeholder","className","getComputedStyle","marginBottom","height","parseInt","insertBefore","pageYOffset","setTimeout","add","remove","getElementsByClassName","el","body","show","scrollY","$popover","h","pageX","i","offsetWidth","offsetLeft","offsetParent","width","removeClass","css","addClass","hide","smart_truncate","substr","lastIndexOf","getRelatedTwitterAccounts","attr","push","getElementsByTagName","attributes","href","value","indexOf","join","shareTwitter","preventDefault","viaTwitterAccount","replace","relatedTwitterAccounts","trim","encodeURIComponent","location","screen","open","shareEmail","subject","title","render","find","click","append","$popunder","setElements","$elements","mouseup","mousedown","bind","isMobile","onselectionchange","selectionChanged","lastSelectionChanged","clearTimeout","fn","selectionSharer","define","load","SelectionSharer","jQuery"],"mappings":"CAAA,SAAAA,GAAA,GAAAC,GAAA,SAAAA,GAAA,GAAAC,GAAAC,IAAAF,GAAAA,MAAA,gBAAAA,KAAAA,GAAAG,SAAAH,IAAAE,KAAAE,IAAA,KAAAF,KAAAG,cAAA,GAAAH,KAAAI,cAAA,GAAAJ,KAAAK,iBAAA,SAAAR,GAAA,GAAAC,GAAA,GAAAQ,EAAA,GAAAT,EAAAA,GAAAU,OAAAC,cAAA,IAAAX,EAAAY,WAAA,CAAA,IAAA,GAAAC,GAAAC,SAAAC,cAAA,OAAAC,EAAA,EAAAC,EAAAjB,EAAAY,WAAAK,EAAAD,IAAAA,EAAAH,EAAAK,YAAAlB,EAAAmB,WAAAH,GAAAI,gBAAAX,GAAAI,EAAAQ,YAAApB,EAAAY,EAAAS,UAAA,MAAApB,GAAAI,cAAAG,EAAAP,EAAAK,cAAAN,GAAAQ,EAAAA,GAAAN,KAAAoB,mBAAA,SAAAvB,GAAA,GAAAC,GAAAD,GAAAU,OAAAC,eAAAT,EAAAY,SAAAU,aAAA,KAAAvB,EAAAwB,WAAA,MAAA,EAAAvB,GAAAwB,SAAAzB,EAAAwB,WAAAxB,EAAA0B,cAAAzB,EAAA0B,OAAA3B,EAAA4B,UAAA5B,EAAA6B,YAAA,IAAArB,GAAAP,EAAA6B,UAAA,WAAA,SAAA,OAAA7B,GAAA8B,SAAAvB,GAAAN,KAAA8B,aAAA,WAAA/B,EAAAgC,SAAAhC,EAAAgC,UAAApB,SAAAqB,eAAA,0BAAA,IAAAnC,GAAAU,OAAAC,eAAAV,EAAAC,EAAAM,iBAAAR,EAAA,IAAAA,EAAAoC,aAAAnC,EAAAoC,OAAA,KAAApC,EAAAqC,MAAA,KAAA,MAAApC,GAAAqC,cAAA,IAAArC,EAAAgC,SAAAM,UAAAC,SAAA,SAAA,MAAAvC,GAAAgC,SAAAQ,MAAAC,OAAA,CAAA,IAAAlC,GAAAT,EAAAmB,WAAA,GAAAN,EAAAJ,EAAAmC,aAAAC,UAAA,IAAA3C,EAAAgC,SAAAM,UAAAC,SAAA,QAAA,CAAA,GAAAK,KAAAC,KAAA7C,EAAAgC,SAAAc,wBAAAC,MAAAH,KAAAC,KAAAlC,EAAAmC,wBAAAL,QAAA,MAAA,OAAAzC,GAAAqC,aAAArC,EAAA+B,cAAA,GAAApB,EAAAqC,mBAAAhD,EAAAiD,aAAAtC,OAAA,CAAAX,EAAAkD,cAAAlD,EAAAkD,YAAAtC,SAAAC,cAAA,OAAAb,EAAAkD,YAAAC,UAAA,6BAAA,IAAArC,GAAAN,OAAA4C,iBAAAzC,GAAA0C,YAAArD,GAAAkD,YAAAV,MAAAc,OAAAxC,EAAAd,EAAAkD,YAAAV,MAAAa,aAAA,GAAAE,SAAAzC,EAAA,IAAA,KAAAH,EAAAgC,WAAAa,aAAAxD,EAAAkD,aAAA,GAAAnC,GAAAP,OAAAiD,YAAA9C,EAAAmC,wBAAAL,MAAAzC,GAAAgC,SAAAQ,MAAAO,IAAAH,KAAAC,KAAA9B,GAAA,KAAA2C,WAAA,WAAA1D,EAAAkD,aAAAlD,EAAAkD,YAAAZ,UAAAqB,IAAA,QAAA3D,EAAAgC,SAAAM,UAAAqB,IAAA,SAAA,IAAA1D,KAAAgD,aAAA,SAAAnD,GAAA,KAAAA,EAAAA,EAAAkD,oBAAAlD,EAAAwC,UAAAqB,IAAA,mBAAA7D,EAAAwC,UAAAqB,IAAA,aAAA1D,KAAAoC,aAAA,SAAAvC,GAAA,GAAAA,EAAAA,GAAA,aAAA,SAAAE,EAAAgC,SAAA,MAAAhC,GAAAgC,SAAAQ,MAAAC,OAAA,QAAA3C,GAAAE,GAAAgC,SAAAM,UAAAsB,OAAA,QAAA5D,EAAAkD,aAAAlD,EAAAkD,YAAAZ,UAAAsB,OAAA,OAAA,KAAA,GAAA7D,GAAAa,SAAAiD,uBAAA,YAAAC,GAAA/D,EAAA,IAAA+D,GAAAxB,UAAAsB,OAAA,WAAAF,YAAA,WAAA1D,EAAAkD,aAAAtC,SAAAmD,KAAAP,aAAAxD,EAAAkD,aAAApD,KAAA,MAAAG,KAAA+D,KAAA,SAAAlE,GAAA4D,WAAA,WAAA,GAAA3D,GAAAS,OAAAC,eAAAF,EAAAP,EAAAM,iBAAAP,EAAA,KAAAA,EAAAmC,aAAA3B,GAAAA,EAAA4B,OAAA,IAAA5B,EAAA6B,MAAA,KAAA,CAAA,GAAAzB,GAAAZ,EAAAkB,WAAA,GAAAH,EAAAH,EAAAmC,wBAAAC,IAAA,EAAAhC,EAAAD,EAAAN,OAAAyD,QAAAjE,EAAAkE,SAAAZ,SAAAa,EAAA,CAAA,IAAArE,EAAAqE,EAAArE,EAAAsE,UAAA,CAAA,GAAAC,GAAAtE,EAAAwB,WAAAoB,UAAAwB,IAAAE,EAAAC,YAAA,CAAA,GAAAH,IAAAE,EAAAE,iBAAAF,EAAAA,EAAAG,cAAA,OAAAxE,EAAAqB,mBAAAtB,IAAA,IAAA,UAAAoE,GAAAnE,EAAAkE,SAAAO,OAAA,MAAA,KAAA,WAAAN,GAAAnE,EAAAkE,SAAAO,OAAA,MAAA,SAAA,OAAAzE,EAAAkE,SAAAQ,YAAA,QAAAC,IAAA,MAAA5D,EAAA,IAAA4D,IAAA,OAAAR,GAAAH,OAAAN,WAAA,WAAA1D,EAAAkE,SAAAU,SAAA,QAAAD,IAAA,MAAA5D,IAAA,KAAA,KAAAd,KAAA4E,KAAA,WAAA7E,EAAAkE,SAAAW,QAAA5E,KAAA6E,eAAA,SAAAhF,EAAAC,GAAA,IAAAD,IAAAA,EAAAqC,OAAA,MAAArC,EAAA,IAAAE,GAAAF,EAAAqC,OAAApC,EAAAQ,EAAAP,EAAAF,EAAAiF,OAAA,EAAAhF,EAAA,GAAAD,CAAA,OAAAS,GAAAP,EAAAO,EAAAwE,OAAA,EAAAxE,EAAAyE,YAAA,MAAAzE,EAAAP,EAAAO,EAAA,MAAAA,GAAAN,KAAAgF,0BAAA,WAAA,GAAAlF,MAAAC,EAAAF,EAAA,gCAAAoF,KAAA,YAAApF,EAAA,gCAAAoF,KAAA,QAAAlF,IAAAD,EAAAoF,KAAAnF,EAAA,KAAA,GAAAO,GAAAK,SAAAwE,qBAAA,KAAAzE,EAAA,EAAAG,EAAAP,EAAA4B,OAAArB,EAAAH,EAAAA,IAAA,GAAAJ,EAAAI,GAAA0E,WAAAC,MAAA,gBAAA/E,GAAAI,GAAA0E,WAAAC,KAAAC,MAAA,CAAA,GAAAxE,GAAAR,EAAAI,GAAA0E,WAAAC,KAAAC,MAAAnD,MAAA,+CAAArB,IAAAA,EAAAoB,OAAA,GAAA,KAAA,UAAA,UAAAqD,QAAAzE,EAAA,KAAAhB,EAAAoF,KAAApE,EAAA,IAAA,MAAAhB,GAAAoC,OAAA,EAAApC,EAAA0F,KAAA,KAAA,IAAAxF,KAAAyF,aAAA,SAAA3F,GAAAA,EAAA4F,iBAAA3F,EAAA4F,oBAAA5F,EAAA4F,kBAAA9F,EAAA,6BAAAoF,KAAA,YAAApF,EAAA,6BAAAoF,KAAA,UAAA,GAAAlF,EAAA4F,kBAAA5F,EAAA4F,kBAAAC,QAAA,IAAA,KAAA7F,EAAA8F,yBAAA9F,EAAA8F,uBAAA9F,EAAAiF,4BAAA,IAAA1E,GAAA,IAAAP,EAAA8E,eAAA9E,EAAAI,cAAA2F,OAAA,KAAA,IAAApF,EAAA,wCAAAqF,mBAAAzF,GAAA,YAAAP,EAAA8F,uBAAA,QAAAE,mBAAAxF,OAAAyF,SAAAX,KAAAtF,GAAA4F,mBAAArF,EAAA4B,OAAA,IAAAnC,EAAA4F,kBAAAzD,SAAAxB,GAAA,QAAAX,EAAA4F,kBAAA,IAAA9E,GAAA,IAAAC,EAAA,IAAAoD,EAAA+B,OAAAzB,MAAA,EAAA3D,EAAA,EAAAuD,EAAA6B,OAAA5C,OAAA,EAAAvC,EAAA,EAAA,GAAA,OAAAP,QAAA2F,KAAAxF,EAAA,gBAAA,sHAAAG,EAAA,YAAAC,EAAA,eAAAsD,EAAA,UAAAF,GAAAnE,EAAA6E,QAAA,GAAA5E,KAAAmG,WAAA,WAAA,GAAArG,GAAAC,EAAAK,cAAAwF,QAAA,aAAA,MAAAA,QAAA,aAAA,IAAAE,OAAAxF,IAAA,OAAAA,GAAA8F,QAAAL,mBAAA,cAAApF,SAAA0F,OAAA/F,EAAAwD,KAAAiC,mBAAA,IAAAjG,EAAA,KAAA,qBAAAa,SAAA0F,MAAA,SAAA9F,OAAAyF,SAAAX,KAAAxF,EAAAG,MAAAiF,KAAA,OAAA,mBAAA3E,EAAA8F,QAAA,SAAA9F,EAAAwD,MAAA/D,EAAA6E,QAAA,GAAA5E,KAAAsG,OAAA,WAAA,GAAAxG,GAAA,mmBAAAQ,EAAA,6gBAAAP,GAAAkE,SAAApE,EAAAC,GAAAC,EAAAkE,SAAAsC,KAAA,WAAAC,MAAAzG,EAAA0F,cAAA1F,EAAAkE,SAAAsC,KAAA,WAAAC,MAAAzG,EAAAoG,YAAAtG,EAAA,QAAA4G,OAAA1G,EAAAkE,UAAAlE,EAAA2G,UAAA7G,EAAAS,GAAAP,EAAA2G,UAAAH,KAAA,WAAAC,MAAAzG,EAAA0F,cAAA1F,EAAA2G,UAAAH,KAAA,WAAAC,MAAAzG,EAAAoG,YAAAtG,EAAA,QAAA4G,OAAA1G,EAAA2G,YAAA1G,KAAA2G,YAAA,SAAA7G,GAAA,gBAAAA,KAAAA,EAAAD,EAAAC,IAAAC,EAAA6G,UAAA9G,YAAAD,GAAAC,EAAAD,EAAAC,GAAAC,EAAA6G,UAAAC,QAAA9G,EAAAgE,MAAA+C,UAAA/G,EAAA6E,MAAAD,SAAA,sBAAA5E,EAAA6G,UAAAG,KAAA,aAAA,WAAAhH,EAAAiH,UAAA,IAAArG,SAAAsG,kBAAAlH,EAAAmH,kBAAAlH,KAAAkH,iBAAA,SAAArH,GAAAE,EAAAiH,WAAAjH,EAAAoH,sBAAAC,aAAArH,EAAAoH,sBAAApH,EAAAoH,qBAAA1D,WAAA,WAAA1D,EAAA+B,aAAAjC,IAAA,OAAAG,KAAAsG,SAAAxG,EAAAG,UAAAD,KAAA2G,YAAA7G,EAAAG,UAAAJ,GAAAwH,GAAAC,gBAAA,WAAA,GAAAzH,GAAA,GAAAC,EAAA,OAAAD,GAAA8G,YAAA3G,MAAAA,MAAA,kBAAAuH,QAAAA,OAAA,WAAA,MAAAzH,GAAA0H,KAAA,SAAA3H,EAAAE,EAAAO,GAAA,GAAAI,GAAA,GAAAZ,EAAAY,GAAAiG,YAAA,KAAArG,KAAAR,IAAAS,OAAAkH,gBAAA3H,GAAA4H","file":"selection-sharer.js","sourcesContent":["/* @author: Xavier Damman (@xdamman) - http://github.com/xdamman/selection-sharer - @license: MIT */!function(a){var b=function(b){var c=this;b=b||{},\"string\"==typeof b&&(b={elements:b}),this.sel=null,this.textSelection=\"\",this.htmlSelection=\"\",this.getSelectionText=function(a){var b=\"\",d=\"\",a=a||window.getSelection();if(a.rangeCount){for(var e=document.createElement(\"div\"),f=0,g=a.rangeCount;g>f;++f)e.appendChild(a.getRangeAt(f).cloneContents());d=e.textContent,b=e.innerHTML}return c.textSelection=d,c.htmlSelection=b||d,d},this.selectionDirection=function(a){var b=a||window.getSelection(),c=document.createRange();if(!b.anchorNode)return 0;c.setStart(b.anchorNode,b.anchorOffset),c.setEnd(b.focusNode,b.focusOffset);var d=c.collapsed?\"backward\":\"forward\";return c.detach(),d},this.showPopunder=function(){c.popunder=c.popunder||document.getElementById(\"selectionSharerPopunder\");var a=window.getSelection(),b=c.getSelectionText(a);if(a.isCollapsed||b.length<10||!b.match(/ /))return c.hidePopunder();if(c.popunder.classList.contains(\"fixed\"))return c.popunder.style.bottom=0;var d=a.getRangeAt(0),e=d.endContainer.parentNode;if(c.popunder.classList.contains(\"show\")){if(Math.ceil(c.popunder.getBoundingClientRect().top)==Math.ceil(e.getBoundingClientRect().bottom))return;return c.hidePopunder(c.showPopunder)}if(e.nextElementSibling)c.pushSiblings(e);else{c.placeholder||(c.placeholder=document.createElement(\"div\"),c.placeholder.className=\"selectionSharerPlaceholder\");var f=window.getComputedStyle(e).marginBottom;c.placeholder.style.height=f,c.placeholder.style.marginBottom=-2*parseInt(f,10)+\"px\",e.parentNode.insertBefore(c.placeholder)}var g=window.pageYOffset+e.getBoundingClientRect().bottom;c.popunder.style.top=Math.ceil(g)+\"px\",setTimeout(function(){c.placeholder&&c.placeholder.classList.add(\"show\"),c.popunder.classList.add(\"show\")},0)},this.pushSiblings=function(a){for(;a=a.nextElementSibling;)a.classList.add(\"selectionSharer\"),a.classList.add(\"moveDown\")},this.hidePopunder=function(a){if(a=a||function(){},\"fixed\"==c.popunder)return c.popunder.style.bottom=\"-50px\",a();c.popunder.classList.remove(\"show\"),c.placeholder&&c.placeholder.classList.remove(\"show\");for(var b=document.getElementsByClassName(\"moveDown\");el=b[0];)el.classList.remove(\"moveDown\");setTimeout(function(){c.placeholder&&document.body.insertBefore(c.placeholder),a()},600)},this.show=function(a){setTimeout(function(){var b=window.getSelection(),d=c.getSelectionText(b);if(!b.isCollapsed&&d&&d.length>10&&d.match(/ /)){var e=b.getRangeAt(0),f=e.getBoundingClientRect().top-5,g=f+window.scrollY-c.$popover.height(),h=0;if(a)h=a.pageX;else{var i=b.anchorNode.parentNode;h+=i.offsetWidth/2;do h+=i.offsetLeft;while(i=i.offsetParent)}switch(c.selectionDirection(b)){case\"forward\":h-=c.$popover.width();break;case\"backward\":h+=c.$popover.width();break;default:return}c.$popover.removeClass(\"anim\").css(\"top\",g+10).css(\"left\",h).show(),setTimeout(function(){c.$popover.addClass(\"anim\").css(\"top\",g)},0)}},10)},this.hide=function(){c.$popover.hide()},this.smart_truncate=function(a,b){if(!a||!a.length)return a;var c=a.length>b,d=c?a.substr(0,b-1):a;return d=c?d.substr(0,d.lastIndexOf(\" \")):d,c?d+\"...\":d},this.getRelatedTwitterAccounts=function(){var b=[],c=a('meta[name=\"twitter:creator\"]').attr(\"content\")||a('meta[name=\"twitter:creator\"]').attr(\"value\");c&&b.push(c);for(var d=document.getElementsByTagName(\"a\"),e=0,f=d.length;f>e;e++)if(d[e].attributes.href&&\"string\"==typeof d[e].attributes.href.value){var g=d[e].attributes.href.value.match(/^https?:\\/\\/twitter\\.com\\/([a-z0-9_]{1,20})/i);g&&g.length>1&&-1==[\"widgets\",\"intent\"].indexOf(g[1])&&b.push(g[1])}return b.length>0?b.join(\",\"):\"\"},this.shareTwitter=function(b){b.preventDefault(),c.viaTwitterAccount||(c.viaTwitterAccount=a('meta[name=\"twitter:site\"]').attr(\"content\")||a('meta[name=\"twitter:site\"]').attr(\"value\")||\"\",c.viaTwitterAccount=c.viaTwitterAccount.replace(/@/,\"\")),c.relatedTwitterAccounts||(c.relatedTwitterAccounts=c.getRelatedTwitterAccounts());var d=\"“\"+c.smart_truncate(c.textSelection.trim(),114)+\"”\",e=\"http://twitter.com/intent/tweet?text=\"+encodeURIComponent(d)+\"&related=\"+c.relatedTwitterAccounts+\"&url=\"+encodeURIComponent(window.location.href);c.viaTwitterAccount&&d.length<114-c.viaTwitterAccount.length&&(e+=\"&via=\"+c.viaTwitterAccount);var f=640,g=440,h=screen.width/2-f/2,i=screen.height/2-g/2-100;return window.open(e,\"share_twitter\",\"toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=\"+f+\", height=\"+g+\",       top=\"+i+\", left=\"+h),c.hide(),!1},this.shareEmail=function(){var b=c.htmlSelection.replace(/<p[^>]*>/gi,\"\\n\").replace(/<\\/p>|  /gi,\"\").trim(),d={};return d.subject=encodeURIComponent(\"Quote from \"+document.title),d.body=encodeURIComponent(\"“\"+b+\"”\")+\"%0D%0A%0D%0AFrom: \"+document.title+\"%0D%0A\"+window.location.href,a(this).attr(\"href\",\"mailto:?subject=\"+d.subject+\"&body=\"+d.body),c.hide(),!0},this.render=function(){var b='<div class=\"selectionSharer\" id=\"selectionSharerPopover\" style=\"position:absolute;\">  <div id=\"selectionSharerPopover-inner\">    <ul>      <li><a class=\"action tweet\" href=\"\" title=\"Share this selection on Twitter\" target=\"_blank\">Tweet</a></li>      <li><a class=\"action email\" href=\"\" title=\"Share this selection by email\" target=\"_blank\"><svg width=\"20\" height=\"20\"><path stroke=\"#FFF\" stroke-width=\"6\" d=\"m16,25h82v60H16zl37,37q4,3 8,0l37-37M16,85l30-30m22,0 30,30\"/></svg></a></li>    </ul>  </div>  <div class=\"selectionSharerPopover-clip\"><span class=\"selectionSharerPopover-arrow\"></span></div></div>',d='<div id=\"selectionSharerPopunder\" class=\"selectionSharer\">  <div id=\"selectionSharerPopunder-inner\">    <label>Share this selection</label>    <ul>      <li><a class=\"action tweet\" href=\"\" title=\"Share this selection on Twitter\" target=\"_blank\">Tweet</a></li>      <li><a class=\"action email\" href=\"\" title=\"Share this selection by email\" target=\"_blank\"><svg width=\"20\" height=\"20\"><path stroke=\"#FFF\" stroke-width=\"6\" d=\"m16,25h82v60H16zl37,37q4,3 8,0l37-37M16,85l30-30m22,0 30,30\"/></svg></a></li>    </ul>  </div></div>';c.$popover=a(b),c.$popover.find(\"a.tweet\").click(c.shareTwitter),c.$popover.find(\"a.email\").click(c.shareEmail),a(\"body\").append(c.$popover),c.$popunder=a(d),c.$popunder.find(\"a.tweet\").click(c.shareTwitter),c.$popunder.find(\"a.email\").click(c.shareEmail),a(\"body\").append(c.$popunder)},this.setElements=function(b){\"string\"==typeof b&&(b=a(b)),c.$elements=b instanceof a?b:a(b),c.$elements.mouseup(c.show).mousedown(c.hide).addClass(\"selectionShareable\"),c.$elements.bind(\"touchstart\",function(){c.isMobile=!0}),document.onselectionchange=c.selectionChanged},this.selectionChanged=function(a){c.isMobile&&(c.lastSelectionChanged&&clearTimeout(c.lastSelectionChanged),c.lastSelectionChanged=setTimeout(function(){c.showPopunder(a)},300))},this.render(),b.elements&&this.setElements(b.elements)};a.fn.selectionSharer=function(){var a=new b;return a.setElements(this),this},\"function\"==typeof define?define(function(){return b.load=function(a,c,d){var e=new b;e.setElements(\"p\"),d()},b}):window.SelectionSharer=b}(jQuery);"],"sourceRoot":"/source/"}